module.exports = function(error) {
	
	var err = {
		message: error.message,
		stack: []
	};

	if(!error.stack) return err;

	var stackTrace = error.stack.toString(),
	errParts = stackTrace.split(/\n+\s+at\s+/);

	errParts.shift();//remove the message
	

	for(var i = 0, n = errParts.length; i < n; i++) {

		var trace  = errParts[i],
		traceParts = trace.split(' '),
		source     = traceParts.pop().replace(/[\(\)]+/g,'').split(':');

		var fn     = traceParts.join(' ');


		err.stack.push({
			source: fn,
			col: Number(source.pop()),
			line: Number(source.pop()),
			file: source.join(':')
		})

	}


	return err;
}